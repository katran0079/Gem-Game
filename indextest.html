<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Gem Game</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    />

    <link rel="stylesheet" href="style.css" />
  </head>
  <body background="assets/cave.jpg">
    <div class="row">
      <div class="col-sm-3"></div>
      <div class="col-sm-6">
        <h1 id="head">Miner Problem</h1>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-3"></div>
      <div class="jumbotron" class="col-sm-8">
        <div class="row">
          <div class="col-sm-2"></div>
          <div class="col-sm-8">
            <h2>How to Play</h2>
            <p>
              Your goal is to collect $150 worth of gems. Click the gems to
              collect them! Each gem is worth a different amount. Don't get too
              greedy though, the mines are treacherous and collecting more than
              the required amount will bring dire consequences.
            </p>
            <button type="button" class="btn btn-danger playMusic">
              Play Background Music
            </button>
            <button type="button" class="btn btn-danger pauseMusic">
              Pause
            </button>
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-3"></div>
      <div class="col-sm-3 win">
        <h3>Wins</h3>
        <br />
        <p id="wins">0</p>
      </div>
      <div class="col-sm-3 loss">
        <h3>Losses</h3>
        <br />
        <p id="losses">0</p>
      </div>
    </div>
    <div class="row">
      <div class="col-sm-3"></div>
      <div class="col-sm-6">
        <div id="gemcounter">
          <h3>Gems Collected</h3>
          <br />
          <p id="gemsCollected"></p>
        </div>
      </div>
    </div>

    <div class="row gemsHolder">
      <div class="col-sm-4"></div>
      <div class="col-sm-1 gem1">
        <img src="assets/gem1.png" id="gem1" />
      </div>
      <div class="col-sm-1 gem2">
        <img src="assets/gem2.png" id="gem2" />
      </div>
      <div class="col-sm-1 gem3">
        <img src="assets/gem3.png" id="gem3" />
      </div>
      <div class="col-sm-1 gem4">
        <img src="assets/gem4.png" id="gem4" />
      </div>
    </div>

    <script>
      var gem1;
      var gem2;
      var gem3;
      var gem4;
      var wins = 0;
      var losses = 0;
      var gemCounter = 0;

      function startgame() {
        gemCounter = 0;
        $("#gemsCollected").text("$ " + 0);
        gem1 = Math.ceil(Math.random() * 10);
        gem2 = Math.ceil(Math.random() * 15);
        gem3 = Math.ceil(Math.random() * 20);
        gem4 = Math.ceil(Math.random() * 40);
        playGame();
        console.log(gem1);
        console.log(gem2);
        console.log(gem3);
        console.log(gem4);
      }

      function playGame() {
        $("#gem1").on("click", function() {
          gemCounter = gemCounter + gem1;
          $("#gemsCollected").text("$ " + gemCounter);
          winCondition();
        });
        $("#gem2").on("click", function() {
          gemCounter = gemCounter + gem2;
          $("#gemsCollected").text("$ " + gemCounter);
          winCondition();
        });
        $("#gem3").on("click", function() {
          gemCounter = gemCounter + gem3;
          $("#gemsCollected").text("$ " + gemCounter);
          winCondition();
        });
        $("#gem4").on("click", function() {
          gemCounter = gemCounter + gem4;
          $("#gemsCollected").text("$ " + gemCounter);
          winCondition();
        });
        $("#Reset").on("click", function() {
          startGame();
        });
      }

      function winCondition() {
        if (gemCounter > 150) {
          alert(
            "As you strike the walls with your pickaxe, the earth around you begins to shake violently. Rocks begin to fall from the ceiling."
          );
          alert(
            "Luckily you manage to make it unscathed back to the entrance. However you find that the entrance has caved in."
          );
          alert(
            "You scream for help, only to hear your cries echo off the walls. Cut off from the rest of the world, you would continue to remain here for the rest of your days. Your greed has cost you everything."
          );
          alert("Game over, man.");
          losses++;
          gemCounter = 0;
          $("#losses").text(losses);
          startgame();
        }

        if (gemCounter === 150) {
          alert("You won! Play Again!");
          wins++;
          $("#wins").text(wins);
          startgame();
        }
      }
      var audioElement = document.createElement("audio");
      audioElement.setAttribute("src", "assets/cave.mp3");
      $(".playMusic").on("click", function() {
        audioElement.play();
      });
      $(".pauseMusic").on("click", function() {
        audioElement.pause();
      });
      //win conditions
      startgame();
      winCondition();
    </script>
  </body>
</html>
